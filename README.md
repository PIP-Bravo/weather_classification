# Submission 1: Weather Classification using TFX Pipeline
Nama: Alfonso

Username dicoding: bravo_alfon

| | Deskripsi |
| ----------- | ----------- |
| Dataset | [Multi-class Weather Dataset](https://www.kaggle.com/datasets/pratik2901/multiclass-weather-dataset/data) |
| Masalah | Cuaca menjadi salah satu hal yang pastinya tidak dapat terlepas dari kehidupan kita sehari-hari. Setiap kegiatan kita baik di dalam maupun di luar ruangan, seringkali dapat dipengaruhi oleh kondisi cuaca yang ada. Apalagi bagi sektor pertanian dan transportasi, cuaca menjadi hal yang sangat krusial. Dalam sektor pertanian misalnya, deteksi cuaca sangat diperlukan untuk menemukan waktu yang tepat dalam membajak / menanam di sawah. Namun adanya kondisi cuaca yang terkadang tidak menentu, dan kondisi petani yang tidak selalu siaga untuk dapat bertindak secara langsung menjadi suatu masalah. Oleh karena itu diperlukan suatu sistem cerdas sebagai solusi untuk dapat mengotomasi hal-hal tersebut. |
| Solusi machine learning | Solusi yang dibangun adalah model machine learning berbasis deep learning untuk melakukan klasifikasi kondisi cuaca dari citra gambar. Model ini dirancang untuk mengklasifikasikan gambar ke dalam empat kategori: **Cloudy, Rain, Shine,** dan **Sunrise**. Dengan adanya model ini, diharapkan proses prediksi cuaca berbasis citra menjadi lebih cepat, konsisten, dan akurat. Hasil dari prediksi model ini kemudian dapat menjadi sumber pengambilan keputusan alat otomasi yang dapat membantu dalam kehidupan sehari-hari misalnya dalam kasus pertanian yang telah disebutkan. |
| Metode Pengolahan | Metode pengolahan data dilakukan melalui beberapa tahapan utama : <br><br> 1. **Konversi ke TFRecord dan Pembagian Dataset**: <br> &nbsp;&nbsp;• Data citra mentah pada direktori `raw_images` dikonversi menjadi format TFRecord. <br> &nbsp;&nbsp;• Dataset dibagi menjadi **training set (80%)** dan **evaluation set (20%)** secara terpisah untuk memastikan evaluasi yang adil.  .<br><br> 2. **Transformasi Data dengan TFX Transform**: <br> &nbsp;&nbsp;• **Decode gambar**: gambar dalam format bytes dideserialize menjadi tensor RGB.<br> &nbsp;&nbsp;• **Resize**: ukuran citra diubah ke dimensi tetap **128×128 piksel**.<br> &nbsp;&nbsp;• **Normalisasi**: nilai piksel ditransformasi ke rentang **[0, 1]**.<br> &nbsp;&nbsp;• **Konversi label**: label string (`Cloudy`, `Rain`, `Shine`, `Sunrise`) dipetakan menjadi representasi numerik dengan lookup table. |
| Arsitektur Model | Model yang dibangun merupakan model **Convolutional Neural Network (CNN)** sederhana berbasis **Sequential API Keras**, dengan susunan layer yang difokuskan untuk mengenali pola visual dari citra cuaca. Komposisi modelnya terdiri dari : <br><br> **1. Input Layer** <br> &nbsp;&nbsp;• Menerima citra berukuran 128 × 128 piksel dengan 3 channel warna (RGB). <br> &nbsp;&nbsp;• Input diberi nama `image_xf` agar sesuai dengan hasil transformasi data.<br><br> **2. Feature Extraction (Convolution + Pooling)** <br> &nbsp;&nbsp;• Conv2D(32 filter, kernel 3×3, padding="same", activation=ReLU). <br> &nbsp;&nbsp;• Conv2D(64 filter, kernel 3×3, activation=ReLU). <br> &nbsp;&nbsp;• Conv2D(128 filter, kernel 3×3, activation=ReLU). <br> &nbsp;&nbsp;• Setelah tiap konvolusi ditambahkan MaxPooling2D(2×2) untuk mereduksi dimensi spasial sekaligus menonjolkan fitur penting. <br><br> **3. Flatten Layer** <br> &nbsp;&nbsp;• Mengubah hasil ekstraksi fitur 2D menjadi vektor 1D agar bisa diproses oleh fully connected layer. <br><br> **4. Fully Connected Layer (Dense)** <br> &nbsp;&nbsp;• Satu layer dense dengan 128 unit (default) dan aktivasi ReLU. <br> &nbsp;&nbsp;• Ditambahkan Dropout (0.5) sebagai regularisasi untuk mencegah overfitting.<br><br> **5. Output Layer** <br> &nbsp;&nbsp;• Dense dengan jumlah unit sesuai banyaknya kelas **(4 kelas: Cloudy, Rain, Shine, Sunrise)**. <br> &nbsp;&nbsp;• Menggunakan aktivasi Softmax sehingga output berupa probabilitas masing-masing kelas. <br><br> Berikut hasil ringkasan arsitektur model (`model.summary()`) yang digunakan : <br><br> ![Model Summary](https://raw.githubusercontent.com/PIP-Bravo/weather_classification/refs/heads/main/tfx_model_summary.png) |
| Metrik Evaluasi | Model dievaluasi menggunakan beberapa metrik berikut: <br><br> **1. Accuracy** <br> Mengukur proporsi prediksi yang benar terhadap total keseluruhan data uji. Digunakan sebagai metrik umum untuk menilai performa keseluruhan model. <br> Rumus: <br> &nbsp;&nbsp; `Accuracy = (TP + TN) / (TP + TN + FP + FN)` <br><br> **2. Loss** <br> Menggambarkan seberapa jauh distribusi probabilitas prediksi model dari label sebenarnya. Dalam kasus ini digunakan **Sparse Categorical Crossentropy**, cocok untuk klasifikasi multi-kelas dengan label berupa integer. <br> Rumus (untuk 1 sampel): <br> &nbsp;&nbsp; `Loss = -log(p_yi)` dengan `p_yi` adalah probabilitas prediksi model terhadap kelas sebenarnya `yi`. <br><br> **3. Sparse Categorical Accuracy** <br> Variasi dari akurasi yang digunakan saat label kelas direpresentasikan sebagai integer (bukan one-hot encoding). Metrik ini memeriksa apakah indeks kelas dengan probabilitas prediksi tertinggi sama dengan indeks label sebenarnya. <br> Rumus: <br> &nbsp;&nbsp; `SparseCategoricalAccuracy = 1 jika argmax(ŷ) = y, else 0` <br><br> **4. Precision (Presisi)** <br> Mengukur ketepatan model dalam memprediksi kelas positif. Menjawab pertanyaan: *dari semua prediksi positif, berapa yang benar-benar positif?* <br> Rumus: <br> &nbsp;&nbsp; `Precision = TP / (TP + FP)` <br><br> **5. Recall (Sensitivitas)** <br> Mengukur kemampuan model dalam menemukan semua data yang benar-benar positif. Menjawab pertanyaan: *dari semua data positif aktual, berapa yang berhasil ditemukan model?* <br> Rumus: <br> &nbsp;&nbsp; `Recall = TP / (TP + FN)` <br><br> **6. False Positives (FP)** <br> Jumlah data negatif yang salah diprediksi sebagai positif. Nilai ini membantu memahami seberapa sering model menghasilkan kesalahan tipe I (false alarm). <br><br> **7. True Positives (TP)** <br> Jumlah data positif yang berhasil diprediksi dengan benar oleh model. Semakin tinggi nilai TP, semakin baik model dalam mendeteksi kelas positif. |
| Performa Model | Performa model dapat dilihat dari hasil evaluasi yang ada. Hasil evaluasi terhadap metrik yang digunakan adalah sebagai berikut: <br><br> **1. Accuracy** = **0.894 (89.38%)** <br> Menunjukkan bahwa hampir 9 dari 10 citra cuaca berhasil diklasifikasikan dengan benar oleh model. <br><br> **2. Loss** = **0.473** <br> Nilai loss cukup rendah, mengindikasikan bahwa distribusi probabilitas prediksi model tidak terlalu jauh dari label sebenarnya, sehingga model cukup stabil dalam melakukan prediksi.  <br><br> **3. Sparse Categorical Accuracy** = **0.894 (89.38%)** <br> Nilai ini konsisten dengan akurasi, menegaskan bahwa model berhasil memilih indeks kelas yang benar pada sebagian besar prediksi. <br><br> **4. Precision** = **0.893 (89.33%)** <br> Artinya, dari semua prediksi positif yang dibuat model, sekitar 89% benar-benar sesuai dengan kelas aslinya. Dengan kata lain, kesalahan tipe I (false alarm) relatif rendah. <br><br> **5. Recall** = **0.889 (88.94%)** <br> Menunjukkan kemampuan model untuk menemukan data positif cukup baik, yaitu hampir 89% dari semua sampel positif berhasil terdeteksi dengan benar. <br><br> **6. False Positives (FP)** = **24** <br> Terdapat 24 kasus di mana citra negatif salah diprediksi sebagai kelas positif. <br><br> **7. True Positives (TP)** = **201** <br> Sebanyak 201 citra positif berhasil diprediksi dengan benar, menunjukkan bahwa model sudah cukup efektif dalam mendeteksi kelas target. <br><br> **Kesimpulan**: <br> Secara keseluruhan, model CNN yang dibangun mampu mencapai performa yang baik dengan akurasi hampir 90%. Nilai precision dan recall yang seimbang menunjukkan model tidak hanya akurat tetapi juga cukup konsisten dalam mendeteksi kelas positif tanpa terlalu banyak menghasilkan kesalahan. Nilai loss yang relatif rendah memperkuat bahwa model sudah terlatih dengan cukup baik, meskipun masih terdapat beberapa kesalahan klasifikasi (24 false positives). Dengan performa ini, model dapat diandalkan untuk melakukan klasifikasi cuaca berbasis citra dengan tingkat kepercayaan yang tinggi.
|